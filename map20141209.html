<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
   <head>
      <title>SetCredentials</title>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

      <script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?
v=6.3"></script>

      <script type="text/javascript">
         var map     = null;
         
         function GetMap()
         {
            map = new VEMap('myMap');
            map.SetCredentials("Your Bing Maps Key");
     
            map.LoadMap(new VELatLong(47.60802,-122.30873),14); 
			//map.LoadMap(); 
			
			var pointString = "47.60802,-122.30873),(47.60802,-122.30748),(47.60802,-122.30651),(47.60802,-122.30622),(47.60802,-122.30595),(47.60802,-122.30524),(47.60802,-122.30481),(47.60801,-122.30444),(47.60801,-122.30423),(47.60801,-122.30398),(47.60801,-122.30372),(47.608,-122.3032),(47.608,-122.30296),(47.60801,-122.30279),(47.60702,-122.30279),(47.60679,-122.30279),(47.60648,-122.30279),(47.60633,-122.30278),(47.60607,-122.30277),(47.60581,-122.30277),(47.60556,-122.30275),(47.60539,-122.30272),(47.60517,-122.30266),(47.605,-122.30259),(47.6048,-122.30252),(47.60459,-122.30246),(47.60438,-122.30243),(47.60359,-122.30242),(47.60261,-122.30243),(47.60217,-122.30242),(47.60198,-122.30241),(47.60178,-122.30236),(47.60151,-122.30229),(47.60133,-122.30226),(47.60116,-122.30224),(47.60066,-122.30223),(47.60026,-122.30223),(47.59971,-122.30222),(47.59941,-122.30222),(47.59916,-122.30221),(47.59885,-122.30222),(47.59867,-122.30222),(47.5985,-122.30223),(47.59829,-122.30224),(47.5981,-122.30224),(47.59795,-122.30223),(47.59771,-122.30222),(47.59746,-122.30222),(47.5973,-122.30221),(47.597,-122.30224),(47.59677,-122.30224),(47.59658,-122.30224),(47.59631,-122.30224),(47.59603,-122.30224),(47.59583,-122.30223),(47.59557,-122.30224),(47.595531,-122.3029615),(47.595531,-122.30437),(47.59592,-122.30437),(47.59592,-122.30498),(47.59593,-122.30548),(47.59592,-122.30619),(47.59589,-122.30653),(47.59587,-122.30679),(47.59587,-122.30719),(47.59587,-122.30774),(47.59587,-122.3083),(47.59587,-122.30963),(47.59587,-122.31092),(47.59588,-122.31131),(47.59583,-122.31153),(47.59583,-122.3118),(47.59582,-122.31213),(47.59581,-122.31233),(47.59582,-122.31297),(47.59581,-122.31392),(47.59581,-122.31473),(47.59582,-122.31631),(47.59583,-122.3186),(47.59582,-122.31931),(47.59583,-122.32171),(47.59583,-122.32305),(47.59583,-122.32416),(47.59584,-122.32545),(47.59584,-122.32623),(47.59584,-122.32733),(47.59581,-122.32771),(47.59599,-122.32811),(47.59632,-122.32874),(47.59643,-122.32949),(47.59646,-122.33033),(47.5968,-122.33034),(47.59681,-122.33206),(47.59681,-122.33324),(47.5965,-122.33326),(47.5965,-122.3342),(47.59657,-122.33759),(47.597279098413,-122.340736),(47.597290923077,-122.340736),(47.59799,-122.34048),(47.59877,-122.34019),(47.59905,-122.34002),(47.59908,-122.33978),(47.59908,-122.33901),(47.59908,-122.33833),(47.59914,-122.33737),(47.59936,-122.33734),(47.59941,-122.33718),(47.59939,-122.337),(47.59938,-122.33685),(47.59954,-122.33686),(47.59962,-122.33701),(47.59966,-122.33713),(47.5997,-122.33727),(47.59973,-122.33743),(47.59973,-122.33771),(47.59973,-122.33823),(47.59973,-122.33923),(47.59974,-122.33962),(47.59992,-122.33965),(47.6004,-122.33962),(47.60042,-122.33942),(47.60043,-122.33802),(47.60043,-122.33695),(47.60059,-122.3369),(47.6008,-122.33685),(47.6008,-122.33625),(47.60108,-122.33635),(47.60124,-122.33641),(47.60136,-122.33648),(47.60153,-122.33661),(47.60177,-122.33607),(47.60176,-122.33591),(47.60175,-122.33566),(47.60175,-122.33545),(47.60174,-122.33532),(47.60175,-122.33486),(47.60174,-122.33439),(47.60173,-122.33372),(47.60187,-122.33355),(47.60207,-122.33309),(47.60224,-122.33268),(47.60237,-122.33238),(47.60268,-122.33164),(47.603,-122.33086),(47.60328,-122.33021),(47.60344,-122.32979),(47.60356,-122.32949),(47.60374,-122.32901),(47.6039,-122.32862),(47.604,-122.32841),(47.60409,-122.32822),(47.60438,-122.32753),(47.60471,-122.32675),(47.60486,-122.32638),(47.60504,-122.32596),(47.60511,-122.3258),(47.60538,-122.32517),(47.60549,-122.32491),(47.60562,-122.32459),(47.60578,-122.32422),(47.60606,-122.32356),(47.60619,-122.32324),(47.60628,-122.32304),(47.60654,-122.32239),(47.60674,-122.32193),(47.60688,-122.32159),(47.607,-122.32132),(47.6073,-122.32059),(47.60777,-122.31948),(47.60784,-122.31929),(47.60791,-122.31912),(47.60795,-122.31897),(47.60799,-122.31881),(47.60803,-122.31858),(47.60805,-122.3183),(47.608059,-122.317985),(47.608059,-122.317812),(47.60805,-122.31657),(47.60805,-122.31534),(47.60804,-122.3141),(47.60804,-122.31275),(47.60803,-122.3114),(47.60803,-122.31015";

			DrawMap(map, pointString, new VEColor(100,100,150,0.5));
			
			pointString = "47.60804,-122.3141),(47.60804,-122.31275),(47.60803,-122.3114),(47.60803,-122.31015),(47.60802,-122.30873),(47.60802,-122.30748),(47.60802,-122.30651),(47.60802,-122.30622),(47.60802,-122.30595),(47.60802,-122.30524),(47.60802,-122.30481),(47.60801,-122.30444),(47.60801,-122.30423),(47.60801,-122.30398),(47.60801,-122.30372),(47.608,-122.3032),(47.608,-122.30296),(47.60801,-122.30279),(47.60702,-122.30279),(47.60679,-122.30279),(47.60648,-122.30279),(47.60633,-122.30278),(47.60607,-122.30277),(47.60581,-122.30277),(47.60556,-122.30275),(47.60539,-122.30272),(47.60517,-122.30266),(47.605,-122.30259),(47.6048,-122.30252),(47.60459,-122.30246),(47.60438,-122.30243),(47.60359,-122.30242),(47.60261,-122.30243),(47.60217,-122.30242),(47.60198,-122.30241),(47.60178,-122.30236),(47.60151,-122.30229),(47.60133,-122.30226),(47.60116,-122.30224),(47.60066,-122.30223),(47.60026,-122.30223),(47.59971,-122.30222),(47.59941,-122.30222),(47.59916,-122.30221),(47.59885,-122.30222),(47.59867,-122.30222),(47.5985,-122.30223),(47.59829,-122.30224),(47.5981,-122.30224),(47.59795,-122.30223),(47.59771,-122.30222),(47.59746,-122.30222),(47.5973,-122.30221),(47.597,-122.30224),(47.59677,-122.30224),(47.59658,-122.30224),(47.59631,-122.30224),(47.59603,-122.30224),(47.59583,-122.30223),(47.59557,-122.30224),(47.59553,-122.30298),(47.59553,-122.30437),(47.59592,-122.30437),(47.59592,-122.30498),(47.59593,-122.30548),(47.59592,-122.30619),(47.59589,-122.30653),(47.59587,-122.30679),(47.59587,-122.30719),(47.59587,-122.30774),(47.59587,-122.3083),(47.59587,-122.30963),(47.59587,-122.31092),(47.59588,-122.31131),(47.59583,-122.31153),(47.59583,-122.3118),(47.59582,-122.31213),(47.59581,-122.31233),(47.59582,-122.31297),(47.59581,-122.31392),(47.59581,-122.31473),(47.59582,-122.31631),(47.59583,-122.3186),(47.59582,-122.31931),(47.59583,-122.32171),(47.59583,-122.32305),(47.59583,-122.32416),(47.59584,-122.32545),(47.59584,-122.32623),(47.59584,-122.32733),(47.59581,-122.32771),(47.59599,-122.32811),(47.59632,-122.32874),(47.59643,-122.32949),(47.59646,-122.33033),(47.5968,-122.33034),(47.59681,-122.33206),(47.59681,-122.33324),(47.5965,-122.33326),(47.5965,-122.3342),(47.59657,-122.33759),(47.59728,-122.34074),(47.59799,-122.34048),(47.59877,-122.34019),(47.59905,-122.34002),(47.59908,-122.33978),(47.59908,-122.33901),(47.59908,-122.33833),(47.59914,-122.33737),(47.59936,-122.33734),(47.59941,-122.33718),(47.59939,-122.337),(47.59938,-122.33685),(47.59954,-122.33686),(47.59962,-122.33701),(47.59966,-122.33713),(47.5997,-122.33727),(47.59973,-122.33743),(47.59973,-122.33771),(47.59973,-122.33823),(47.59973,-122.33923),(47.59974,-122.33962),(47.59992,-122.33965),(47.6004,-122.33962),(47.60042,-122.33942),(47.60043,-122.33802),(47.60043,-122.33695),(47.60059,-122.3369),(47.6008,-122.33685),(47.6008,-122.33625),(47.60108,-122.33635),(47.60124,-122.33641),(47.60136,-122.33648),(47.60153,-122.33661),(47.60177,-122.33607),(47.60176,-122.33591),(47.60175,-122.33566),(47.60175,-122.33545),(47.60174,-122.33532),(47.60175,-122.33486),(47.60174,-122.33439),(47.60173,-122.33372),(47.60187,-122.33355),(47.60207,-122.33309),(47.60224,-122.33268),(47.60237,-122.33238),(47.60268,-122.33164),(47.603,-122.33086),(47.60328,-122.33021),(47.60344,-122.32979),(47.60356,-122.32949),(47.60374,-122.32901),(47.6039,-122.32862),(47.604,-122.32841),(47.60409,-122.32822),(47.60438,-122.32753),(47.60471,-122.32675),(47.60486,-122.32638),(47.60504,-122.32596),(47.60511,-122.3258),(47.60538,-122.32517),(47.60549,-122.32491),(47.60562,-122.32459),(47.60578,-122.32422),(47.60606,-122.32356),(47.60619,-122.32324),(47.60628,-122.32304),(47.60654,-122.32239),(47.60674,-122.32193),(47.60688,-122.32159),(47.607,-122.32132),(47.6073,-122.32059),(47.60777,-122.31948),(47.60784,-122.31929),(47.60791,-122.31912),(47.60795,-122.31897),(47.60799,-122.31881),(47.60803,-122.31858),(47.60805,-122.3183),(47.60806,-122.31795),(47.60805,-122.31657),(47.60805,-122.31534),(47.60804,-122.3141";
			
			
			//DrawMap(map, pointString, new VEColor(0,100,150,0.5));
			
			
			pointString = "47.608059,-122.340736),(47.608059,-122.302208),(47.595531,-122.302208),(47.595531,-122.340736";			
			
			DrawMap(map, pointString, new VEColor(100,0,150,0.5));
			

         }
		 
		 
		 function DrawMap(map, pointString, color)
		 {
 			var pointStringArray = pointString.split('),(');
 			points=[]
			
			
 			for( var i in pointStringArray)
 			{
 				var xy = pointStringArray[i].split(',');
 				points.push(new VELatLong(parseFloat(xy[0]),parseFloat(xy[1])))
 				var pin = new VEShape(VEShapeType.Pushpin, new VELatLong(parseFloat(xy[0]),parseFloat(xy[1])));
 				pin.SetTitle("#"+i.toString()+",lat="+xy[0]+"long="+xy[1]);
 				//map.AddShape(pin);
 			}

			polygon = new VEShape(VEShapeType.Polygon, points);
			polygon.SetFillColor(color);

			//polygon.HideIcon();

			map.AddShape(polygon);	 
		 }

      </script>
   </head>
   <body onload="GetMap();">
      <div id='myMap' style="position:relative; width:1600px; height:1000px;"></div>
   </body>
</html>
