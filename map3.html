<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
   <head>
      <title>SetCredentials</title>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

      <script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?
v=6.3"></script>

      <script type="text/javascript">
         var map     = null;
         
         function GetMap()
         {
            map = new VEMap('myMap');
            map.SetCredentials("Your Bing Maps Key");
     
            //map.LoadMap(new VELatLong(41.96514,-87.80356)); 
			map.LoadMap(); 
			

			//This is the verification of Andy's classic example, do not remove.
			var pointString ="-115.86328125000495 34.15328996737699,-119.818359375002 45.45290147989422,-81.4101562500034 35.021556836103684,-110.50195312500117 46.97322061018078,-92.66015625000608 43.38159203778072,-94.68164062500398 46.18790776409503,-115.07226562500733 41.63237589430056,-104.17382812500229 40.17099871188528,-100.3945312500027 32.46399995947513,-95.82421875000551 37.08201838643584,-88.52929687500257 35.95188058401679,-84.31054687500303 33.64262887366194,-83.16796875000327 34.51617009551454,-82.37695312500296 32.538125275571225,-84.31054687500303 39.36031127050692,-72.79687500000323 42.739443407624286,-115.86328125000495 34.15328996737699"
			DrawMap(map, pointString, new VEColor(100,100,150,0.5))
			
			pointString ="-119.818359375002 45.45290147989422,-115.86328125000495 34.15328996737699,-102.52676351947564 36.81219275411459,-104.17382812500229 40.17099871188528,-115.07226562500733 41.63237589430056,-109.95811865270818 42.77494310443354,-119.818359375002 45.45290147989422"
			DrawMap(map, pointString, new VEColor(0,100,150,0.5))
			
			pointString ="-110.50195312500117 46.97322061018078,-103.69099150583577 44.1751011402773,-100.33100481371673 44.925766039368476,-110.50195312500117 46.97322061018078"
			DrawMap(map, pointString, new VEColor(0,100,0,0.5))
		
			pointString ="-109.95811865270818 42.77494310443354,-94.15143902809056 38.48198198095287,-91.2441372988624 39.06161099850639,-103.69099150583577 44.1751011402773,-109.95811865270818 42.77494310443354"
			DrawMap(map, pointString, new VEColor(0,100,150,0.5))
			
			pointString ="-102.52676351947564 36.81219275411459,-100.3945312500027 32.46399995947513,-95.82421875000551 37.08201838643584,-88.52929687500257 35.95188058401679,-84.31054687500303 33.64262887366194,-83.16796875000327 34.51617009551454,-82.37695312500296 32.538125275571225,-83.22015254748098 35.513136593728035,-94.15143902809056 38.48198198095287,-102.52676351947564 36.81219275411459"
			DrawMap(map, pointString, new VEColor(50,100,150,0.5))
			
			pointString ="-100.33100481371673 44.925766039368476,-92.66015625000608 43.38159203778072,-94.68164062500398 46.18790776409503,-100.33100481371673 44.925766039368476"
			DrawMap(map, pointString, new VEColor(50,50,150,0.5))
			
			pointString ="-91.2441372988624 39.06161099850639,-83.30099309938232 35.7983615956211,-84.31054687500303 39.36031127050692,-72.79687500000323 42.739443407624286,-91.2441372988624 39.06161099850639"
			DrawMap(map, pointString, new VEColor(50,50,100,0.5))
			
			pointString ="-83.30099309938232 35.7983615956211,-83.22015254748098 35.513136593728035,-81.4101562500034 35.021556836103684,-83.30099309938232 35.7983615956211"
			DrawMap(map, pointString, new VEColor(50,150,50,0.5))
			
         }
		 
		 function DrawMap(map, pointString, color)
		 {
			var pointStringArray = pointString.split(',');
			points=[]
			
			
			for( var i in pointStringArray)
			{
				//var xy = pointStringArray[i].split(',');
				var xy = pointStringArray[i].split(' ');
				points.push(new VELatLong(parseFloat(xy[1]),parseFloat(xy[0])))
				var pin = new VEShape(VEShapeType.Pushpin, new VELatLong(parseFloat(xy[1]),parseFloat(xy[0])));
				pin.SetTitle("#"+i.toString()+",lat="+xy[1]+"\nlong="+xy[0]);
				console.log("i="+i);
				map.AddShape(pin);
			}

			polygon = new VEShape(VEShapeType.Polygon, points);
			polygon.SetFillColor(color);

			//polygon.HideIcon();

			map.AddShape(polygon);
		 }

      </script>
   </head>
   <body onload="GetMap();">
      <div id='myMap' style="position:relative; width:1600px; height:1000px;"></div>
   </body>
</html>