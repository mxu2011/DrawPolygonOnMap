<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
   <head>
      <title>SetCredentials</title>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

      <script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?
v=6.3"></script>

      <script type="text/javascript">
         var map     = null;
         
         function GetMap()
         {
            map = new VEMap('myMap');
            map.SetCredentials("Your Bing Maps Key");
     
            //map.LoadMap(new VELatLong(41.96514,-87.80356)); 
			map.LoadMap(); 
			
			var pointString = "41.96514,-87.80356),(41.96182,-87.80115),(41.96156,-87.79909),(41.96131,-87.79635),(41.96105,-87.79394),(41.9608,-87.79188),(41.95978,-87.78914),(41.95876,-87.78708),(41.95722,-87.78467),(41.95544,-87.78193),(41.95339,-87.77987),(41.9511,-87.77781),(41.94803,-87.77541),(41.94446,-87.773),(41.94063,-87.7706),(41.9368,-87.76785),(41.93271,-87.76545),(41.92658,-87.76339),(41.91687,-87.76133),(41.87522,-87.76373),(41.87445,-87.76579),(41.87394,-87.76854),(41.87368,-87.7706),(41.87343,-87.77335),(41.87266,-87.77575),(41.8724,-87.77815),(41.87215,-87.78021),(41.87164,-87.78296),(41.87113,-87.78536),(41.87113,-87.78776),(41.87113,-87.78982),(41.87113,-87.79223),(41.87113,-87.79463),(41.87113,-87.79703),(41.87138,-87.79978),(41.87189,-87.80184),(41.8724,-87.8039),(41.87317,-87.8063),(41.87419,-87.80871),(41.87471,-87.81077),(41.87547,-87.81283),(41.87649,-87.81523),(41.87726,-87.81729),(41.87752,-87.81935),(41.87777,-87.82141),(41.87803,-87.82347),(41.87828,-87.82622),(41.87854,-87.82862),(41.87854,-87.83171),(41.8788,-87.83377),(41.87931,-87.83652),(41.88007,-87.83926),(41.88058,-87.84132),(41.88135,-87.84373),(41.88237,-87.84613),(41.88365,-87.84888),(41.88493,-87.85094),(41.88697,-87.85334),(41.89055,-87.8554),(41.89515,-87.85746),(41.90026,-87.85952),(41.90435,-87.86158),(41.92913,-87.85952),(41.93373,-87.85746),(41.94139,-87.8554),(41.94573,-87.85334),(41.94778,-87.85094),(41.94905,-87.84888),(41.95059,-87.84647),(41.95263,-87.84304),(41.95365,-87.84098),(41.95442,-87.83892),(41.95671,-87.83514),(41.95773,-87.83308),(41.95901,-87.83102),(41.96003,-87.82862),(41.96207,-87.82484),(41.9631,-87.82107),(41.9631,-87.81901),(41.9631,-87.81695),(41.9631,-87.81351),(41.96284,-87.81042),(41.96233,-87.80699),(41.96207,-87.80424),(41.96156,-87.80184),(41.96105,-87.79978),(41.95901,-87.79703),(41.96514,-87.80356";
			pointString = "29.93101,-95.6968),(29.93101,-95.6992),(29.9319,-95.7016),(29.93309,-95.70401),(29.93428,-95.7071),(29.93488,-95.7095),(29.93547,-95.7119),(29.93607,-95.71431),(29.93666,-95.7174),(29.93726,-95.72014),(29.93785,-95.72255),(29.93875,-95.72564),(29.93994,-95.72804),(29.95094,-95.72598),(29.95303,-95.72358),(29.95481,-95.72152),(29.95659,-95.71877),(29.95778,-95.71637),(29.95838,-95.71362),(29.95838,-95.71122),(29.95838,-95.70847),(29.95808,-95.70538),(29.95778,-95.70195),(29.95719,-95.69851),(29.956,-95.69405),(29.9554,-95.69165),(29.95451,-95.6889),(29.95332,-95.68615),(29.95184,-95.68307),(29.95124,-95.68066),(29.94856,-95.67723),(29.94648,-95.67483),(29.9438,-95.67242),(29.93607,-95.67448),(29.93339,-95.67689),(29.93161,-95.67895),(29.93131,-95.68101),(29.93131,-95.68341),(29.93131,-95.68615),(29.93101,-95.6889),(29.93101,-95.69165),(29.93101,-95.69439),(29.93161,-95.69748),(29.9322,-95.70023),(29.93339,-95.70435),(29.93428,-95.70641),(29.93458,-95.70984),(29.93101,-95.6968"
			pointString = "29.93101,-95.6968),(29.93101,-95.6992),(29.9319,-95.7016),(29.93309,-95.70401),(29.93428,-95.7071),(29.934372825112106,-95.70747130044843),(29.93458,-95.70984),(29.93101,-95.6968"
			pointStringArray = pointString.split('),(');
			pointString = "-78.17273 38.94346,-78.17685 38.93652,-78.18097 38.93171,-78.18578 38.92637,-78.1899 38.91836,-78.19196 38.91622,-78.17273 38.94346"
			
			pointString ="-115.86328125000495 34.15328996737699,-119.818359375002 45.45290147989422,-81.4101562500034 35.021556836103684,-110.50195312500117 46.97322061018078,-92.66015625000608 43.38159203778072,-94.68164062500398 46.18790776409503,-115.07226562500733 41.63237589430056,-104.17382812500229 40.17099871188528,-100.3945312500027 32.46399995947513,-95.82421875000551 37.08201838643584,-88.52929687500257 35.95188058401679,-84.31054687500303 33.64262887366194,-83.16796875000327 34.51617009551454,-82.37695312500296 32.538125275571225,-84.31054687500303 39.36031127050692,-72.79687500000323 42.739443407624286,-115.86328125000495 34.15328996737699"
			DrawMap(map, pointString, new VEColor(100,100,150,0.5))
			
			
			pointString ="-115.86328125000495 34.15328996737699f,-119.818359375002 45.45290147989422,-94.15143902809056 38.48198198095287,-115.86328125000495 34.15328996737699"	
			DrawMap(map, pointString, new VEColor(0,100,150,0.5))
			
			
			pointString ="-94.15143902809056 38.48198198095287,-81.4101562500034 35.021556836103684,-91.2441372988624 39.06161099850639,-94.15143902809056 38.48198198095287"
			DrawMap(map, pointString, new VEColor(0,100,0,0.5))

			pointString ="-91.2441372988624 39.06161099850639,-103.69099150583577 44.1751011402773,-115.07226562500733 41.63237589430056,-104.17382812500229 40.17099871188528,-100.3945312500027 32.46399995947513,-95.82421875000551 37.08201838643584,-88.52929687500257 35.95188058401679,-84.31054687500303 33.64262887366194,-83.16796875000327 34.51617009551454,-82.37695312500296 32.538125275571225,-84.31054687500303 39.36031127050692,-72.79687500000323 42.739443407624286,-91.2441372988624 39.06161099850639"
			DrawMap(map, pointString, new VEColor(0,0,0,0.5))
			
			pointString ="-103.69099150583577 44.1751011402773,-110.50195312500117 46.97322061018078,-100.33100481371673 44.925766039368476,-103.69099150583577 44.1751011402773"
			DrawMap(map, pointString, new VEColor(0,0,125,0.5))
			
			pointString ="-100.33100481371673 44.925766039368476,-92.66015625000608 43.38159203778072,-94.68164062500398 46.18790776409503,-100.33100481371673 44.925766039368476"
			DrawMap(map, pointString, new VEColor(0,60,125,0.5))
			
         }
		 
		 function DrawMap(map, pointString, color)
		 {
			var pointStringArray = pointString.split(',');
			points=[]
			
			
			for( var i in pointStringArray)
			{
				//var xy = pointStringArray[i].split(',');
				var xy = pointStringArray[i].split(' ');
				points.push(new VELatLong(parseFloat(xy[1]),parseFloat(xy[0])))
				var pin = new VEShape(VEShapeType.Pushpin, new VELatLong(parseFloat(xy[1]),parseFloat(xy[0])));
				pin.SetTitle("#"+i.toString()+",lat="+xy[1]+"long="+xy[0]);
				console.log("i="+i);
				map.AddShape(pin);
			}

			polygon = new VEShape(VEShapeType.Polygon, points);
			polygon.SetFillColor(color);

			//polygon.HideIcon();

			map.AddShape(polygon);
		 }

      </script>
   </head>
   <body onload="GetMap();">
      <div id='myMap' style="position:relative; width:1600px; height:1000px;"></div>
   </body>
</html>