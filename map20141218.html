<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
   <head>
      <title>SetCredentials</title>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

      <script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?
v=6.3"></script>

      <script type="text/javascript">
         var map     = null;
         
         function GetMap()
         {
            map = new VEMap('myMap');
            map.SetCredentials("Your Bing Maps Key");
     
            map.LoadMap(new VELatLong(47.60802,-122.30873),14); 
			//map.LoadMap(); 
			
			var pointString = "47.585481,-122.370998),(47.534279,-122.370998),(47.534279,-122.316067),(47.585481,-122.316067),(47.585481,-122.370998";

			DrawMap(map, pointString, new VEColor(100,100,150,0.5));
			
			pointString = "47.60804,-122.3141),(47.60804,-122.31275),(47.60803,-122.3114),(47.60803,-122.31015),(47.60802,-122.30873),(47.60802,-122.30748),(47.60802,-122.30651),(47.60802,-122.30622),(47.60802,-122.30595),(47.60";
			
			
			//DrawMap(map, pointString, new VEColor(0,100,150,0.5));
			
			
			pointString = "47.570101692536,-122.35865173767),(47.549656312814,-122.35865173767),(47.549656312814,-122.32835417399),(47.570101692536,-122.32835417399),(47.570101692536,-122.35865173767";			
			
			DrawMap(map, pointString, new VEColor(100,0,150,0.5));
			

         }
		 
		 
		 function DrawMap(map, pointString, color)
		 {
 			var pointStringArray = pointString.split('),(');
 			points=[]
			
			
 			for( var i in pointStringArray)
 			{
 				var xy = pointStringArray[i].split(',');
 				points.push(new VELatLong(parseFloat(xy[0]),parseFloat(xy[1])))
 				var pin = new VEShape(VEShapeType.Pushpin, new VELatLong(parseFloat(xy[0]),parseFloat(xy[1])));
 				pin.SetTitle("#"+i.toString()+",lat="+xy[0]+"long="+xy[1]);
 				//map.AddShape(pin);
 			}

			polygon = new VEShape(VEShapeType.Polygon, points);
			polygon.SetFillColor(color);

			//polygon.HideIcon();

			map.AddShape(polygon);	 
		 }

      </script>
   </head>
   <body onload="GetMap();">
      <div id='myMap' style="position:relative; width:1600px; height:1000px;"></div>
   </body>
</html>
